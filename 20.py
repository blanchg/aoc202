import time
import numpy as np
from collections import deque, defaultdict


import tkinter as tk
import threading

class App(threading.Thread):

    def __init__(self):
        threading.Thread.__init__(self)
        self.root = None
        self.start()

    def callback(self):
        self.root.quit()

    def run(self):
        self.root = tk.Tk()
        self.root.protocol("WM_DELETE_WINDOW", self.callback)
        self.root.geometry("960x960")
        # label = tk.Label(self.root, text="Day 20")
        # label.pack()

        self.root.mainloop()
app = App()

ms = time.time() * 1000


def flipH(tile):
    for i, r in enumerate(tile):
        tile[i] = list(reversed(r))
    return tile

def flipV(tile):
    t2 = tile[:]
    l = len(t2)
    for i in range(0, l):
        tile[i] = t2[l - 1 - i]
    return tile

def rot90(tile):
    rotated = list(zip(*tile[::-1]))
    return rotated

def rot270(tile):
    rotated = list(zip(*tile))[::-1]
    return rotated

def matchTop(t1, t2) -> bool:
    return t1[0] == t2[len(t2) - 1]

def matchBottom(t1, t2) -> bool:
    return matchTop(t2, t1)

def column(tile, i):
    return [row[i] for row in tile]

def matchLeft(t1, t2) -> bool:
    return column(t1,0) == column(t2, len(t2[0])-1)

def matchRight(t1, t2) -> bool:
    return matchLeft(t2, t1)

class TileMap:

    def __init__(self) -> None:
        super().__init__()
        self.tiles = []
        self.patches = []
        self.patchIndex = {}

    def __repr__(self) -> str:
        output = ""
        for row in self.tiles:
            for t in row:
                output += str(t) + " "
            output += "\n"
        return output

    def add(self, t1, t2, dir):
        if dir == 'top':
            if t1 in self.patchIndex and t2 in self.patchIndex:
                p1 = self.patchIndex[t1]
                p2 = self.patchIndex[t2]
                if p1 == p2:
                    return 0


canvii = {}

def drawTile(index) -> tk.Canvas:
    scale = 8
    if index not in canvii:
        canvii[index] = tk.Canvas(app.root, bg="black", height=10 * scale, width=10 * scale,borderwidth=2,highlightthickness=0)
    canvas = canvii[index]
    canvas.delete("all")

    tile = tiles[index]
    y = 0
    x = 0
    for row in tile:
        x = 0
        for pos in row:
            if pos == '#':
                canvas.create_rectangle(x*scale,y*scale,x*scale+scale,y*scale+scale,outline="gray",fill="gray")
            x += 1
        y += 1
    return canvas

def run1():
    board = np.reshape(list(tiles.keys()), (12,12))
    print(board)
    for y, row in enumerate(board):
        for x, index in enumerate(row):
            c = drawTile(index)
            c.place(x=x * 80, y=y * 80)
    result = 0

    i1 = list(tiles.keys())[0] #board[1][1]
    t1 = tiles[i1]
    c1 = drawTile(i1)
    x = 1
    y = 1
    c1.place(x=x * 80, y=y * 80)
    matches = []
    for op in range(0, 16):
        opmatch = False
        for i2 in tiles.keys():
            if i1 == i2:
                continue
            t2 = tiles[i2]
            c2 = drawTile(i2)
            match = None
            if matchTop(t1, t2):
                print(f'{i1}({op}) matches top {i2}')
                match = 'top'
                c2 = canvii[i2]
                c2.place(x=80, y=0)
            elif matchBottom(t1, t2):
                print(f'{i1}({op}) matches bottom {i2}')
                match = 'bottom'
                c2 = canvii[i2]
                c2.place(x=80, y=160)
            elif matchLeft(t1, t2):
                print(f'{i1}({op}) matches left {i2}')
                match = 'left'
                c2.place(x=0, y=80)
            elif matchRight(t1, t2):
                print(f'{i1}({op}) matches right {i2}')
                match = 'right'
                c2.place(x=160, y=80)
            if match:
                opmatch = True
                matches.append((match, i2, op))
                i1 = i2
                c1 = c2
                t1 = t2
        print('rot')
        t1 = rot90(t1)
        if op == 4:
            print('fliph')
            t1 = flipH(t1)
        elif op == 8:
            print('flipv')
            t1 = flipV(t1)
        elif op == 12:
            print('fliph')
            t1 = flipH(t1)
        tiles[i1] = t1
        # tileops[i1] += 1
        c = drawTile(i1)
        time.sleep(0.5)
        if not opmatch:
            print(f'Could not find a match for {i1}({op})')

    c = drawTile(i1)
    print(i1, matches)
    return result
    # todo = deque(tiles.keys())
    # tileops = defaultdict(int)
    # tilesused = []

    # while todo:
    #     i1 = todo.popleft()
    #     print('Working on', i1)
    #     t1 = tiles[i1]
    #     op = tileops[i1]
    #     match = None
    #     for i2 in tiles.keys():
    #         if i1 == i2 or f'{i1}:{i2}' in tilesused or f'{i2}:{i1}' in tilesused:
    #             continue
    #         t2 = tiles[i2]
    #         if matchTop(t1, t2):
    #             print(f'{i1}({op}) matches top {i2}')
    #             match = 'top'
    #             break
    #         elif matchBottom(t1, t2):
    #             print(f'{i1}({op}) matches bottom {i2}')
    #             match = 'bottom'
    #             break
    #         elif matchLeft(t1, t2):
    #             print(f'{i1}({op}) matches left {i2}')
    #             match = 'left'
    #             break
    #         elif matchRight(t1, t2):
    #             print(f'{i1}({op}) matches right {i2}')
    #             match = 'right'
    #             break

    # return result



def run2():
    result = 1
    return result


tiles = {
3209:[
'.#####.#..',
'.....###..',
'#........#',
'....#.#...',
'..#...####',
'......#...',
'#........#',
'#.##.....#',
'#..#.#....',
'..##.###.#'],

2213:[
'##.#.#..#.',
'##.....#..',
'#..##.##..',
'#.....###.',
'#....#....',
'..........',
'....#.#..#',
'#.........',
'..##....#.',
'...#.###..'],

1277:[
'##.##...##',
'#..#.#..##',
'#.....#.##',
'##..##....',
'...#....##',
'#####..#..',
'#.#..#.###',
'...#....#.',
'#...#..###',
'#.#...##.#'],

2131:[
'#..###.##.',
'.........#',
'..#.......',
'..#...#.##',
'...#...#.#',
'#.#.......',
'..#..#...#',
'.....#...#',
'.##.#.....',
'.##.....#.'],

3911:[
'#.....####',
'..........',
'...#......',
'..#...####',
'#....#....',
'...#....#.',
'..........',
'#.#.......',
'#...#...##',
'#..#.#.###'],

3767:[
'...#...##.',
'#......#..',
'..#....#..',
'..........',
'.....#.#.#',
'#....#.#.#',
'.#...#...#',
'..........',
'#.........',
'.....#.###'],

2741:[
'#...######',
'#.....#.##',
'.....#..#.',
'#.##....##',
'##.#..#...',
'.#...#.##.',
'.#....##.#',
'..#...#..#',
'#.##.....#',
'.....#....'],

2591:[
'.#####...#',
'..###....#',
'#........#',
'...#....#.',
'...##....#',
'.##..#..#.',
'#..##....#',
'...#.....#',
'#.#..#..#.',
'#.##.....#'],

1733:[
'##.#...###',
'.......#..',
'..#....#.#',
'#.#.#...##',
'....#.....',
'##.#.....#',
'......#.##',
'.....#...#',
'......#.##',
'.##...#.#.'],

1823:[
'.##..##..#',
'##..#..###',
'......##.#',
'..........',
'#####.....',
'.#.##...#.',
'.#....#..#',
'.......#..',
'#.#..#.###',
'..#.####.#'],

2341:[
'#.....###.',
'.##.##....',
'##....##..',
'#.....#..#',
'.##......#',
'###.......',
'...#.....#',
'#.##...#..',
'.....##..#',
'...###..##'],

2657:[
'####.##.##',
'#.....#..#',
'#...#....#',
'...#.#....',
'....##...#',
'..#.#.....',
'..#.#.#...',
'...##.####',
'#.##.#..##',
'#.#.####.#'],

2503:[
'.##.#...##',
'.#.#..#..#',
'..........',
'..#......#',
'##..#....#',
'#.....#.##',
'#....#...#',
'#.##..##..',
'##.....##.',
'#..###..#.'],

1103:[
'.##....###',
'..........',
'........##',
'#..#.....#',
'#...#....#',
'........#.',
'.....#...#',
'#.......##',
'..#.....##',
'..####.###'],

3541:[
'###.####..',
'#....#...#',
'..#..#...#',
'#..#..###.',
'##.....#.#',
'#..#.##...',
'......#...',
'..#.....#.',
'....#.#...',
'#...###..#'],

1741:[
'#......##.',
'.##..#....',
'#........#',
'....###...',
'....#..#..',
'.....#.#..',
'#...#.#..#',
'.#...#.#..',
'...#..##..',
'#.#..##.#.'],

3529:[
'###..#...#',
'#...#...##',
'#....#...#',
'#..#....#.',
'.#..#....#',
'..#..#...#',
'....#....#',
'......#...',
'#...#.#..#',
'##....#...'],

1907:[
'...#....##',
'..........',
'..#.#....#',
'#...#.#..#',
'...###....',
'#..##....#',
'.#.#..###.',
'..#..#..#.',
'.....#....',
'#..#.....#'],

1087:[
'.#..##.##.',
'....#.....',
'#...##...#',
'.....#....',
'.....#.#..',
'#......#.#',
'#....##...',
'..#......#',
'.....#.#..',
'#..##.#.##'],

1367:[
'#..#.##...',
'#.#......#',
'..........',
'......##.#',
'#.##.##..#',
'###..##...',
'##....#..#',
'..##..##.#',
'.#........',
'.###.##...'],

1097:[
'.####...#.',
'##....####',
'...#.....#',
'#......#.#',
'.......#.#',
'....#.....',
'#.#.....#.',
'.#..#..#.#',
'....#.#...',
'...###.###'],

3853:[
'.####...##',
'#..#.....#',
'.#......#.',
'.........#',
'........##',
'###..#....',
'....#...##',
'#....#.#..',
'#.......#.',
'##.#..##.#'],

1861:[
'##..##.###',
'#..#......',
'..........',
'.#..##.#..',
'##.#.##...',
'#..#.....#',
'.#.#..#...',
'#........#',
'...#.....#',
'######..##'],

3517:[
'###..#..##',
'#.......#.',
'.........#',
'#.#..#...#',
'##....#...',
'#.........',
'.#.#...#.#',
'.......#..',
'....##...#',
'.#####.#.#'],

1951:[
'....###.##',
'#....#....',
'##.....##.',
'#...#..#..',
'#....##...',
'##.#......',
'#...##.#.#',
'###.....##',
'.#..#.#...',
'.#.####..#'],

3061:[
'#..#.#####',
'#.......#.',
'#.#.##....',
'.#..#.#..#',
'#....###..',
'#......#.#',
'.#.#....#.',
'#.........',
'.....#....',
'#####.##..'],

1319:[
'#..#.....#',
'#.##......',
'..###....#',
'#...#.#.##',
'.#.#.....#',
'#....#...#',
'#...#.#..#',
'#..#.....#',
'....#....#',
'.#...###..'],

2927:[
'.#..##...#',
'#....#...#',
'..#.#..#.#',
'#..#....##',
'#.......#.',
'......###.',
'..#.......',
'#.#.......',
'#..##...##',
'###....#..'],

2711:[
'##.#....##',
'#.........',
'#..#....##',
'....#..#.#',
'#......#.#',
'.....##.#.',
'#.###....#',
'.#....#.##',
'.#..#...#.',
'###.#..#.#'],

3677:[
'###....#.#',
'#.........',
'.....##...',
'#........#',
'.#.#.##..#',
'..##......',
'##......##',
'#.##......',
'.....#.#.#',
'.#..#.#..#'],

3361:[
'#.#######.',
'##.##.#.#.',
'###.#.....',
'.....#.#.#',
'.........#',
'...#......',
'#.##.....#',
'#..#....#.',
'.....#...#',
'.....####.'],

3407:[
'##.##.#.##',
'#..###...#',
'#....#....',
'.#.####...',
'..#..#...#',
'.##..##.##',
'##.#......',
'...#......',
'..........',
'.##.#.####'],

3673:[
'###..#.###',
'..#......#',
'#.....#...',
'.#.......#',
'....#...#.',
'..#...#.#.',
'###...#..#',
'#.##.....#',
'##..###..#',
'...#####.#'],

2351:[
'...#####..',
'#..#....##',
'.#...#...#',
'#.#.......',
'#.....##..',
'.......#..',
'...#....##',
'#.........',
'..#.#....#',
'..########'],

1171:[
'#.#.....#.',
'...###...#',
'..###.#.#.',
'...##..#.#',
'#...#..##.',
'.........#',
'..#.......',
'#.#.....##',
'....#.....',
'#####....#'],

1889:[
'.###..#...',
'#..#....##',
'###..#..##',
'...#..#..#',
'.#....##.#',
'..........',
'#.........',
'...#.....#',
'##........',
'.###...##.'],

2621:[
'##...####.',
'.........#',
'##......##',
'.##.....##',
'...##...##',
'#.#.....##',
'.#.#.#..#.',
'#..#..##.#',
'....#..##.',
'...##.###.'],

1129:[
'##...##.##',
'#.#...##.#',
'#.#.#..###',
'.#.....#.#',
'#...#.....',
'#........#',
'##...#....',
'#.#....###',
'#.##..#..#',
'.#......##'],

3863:[
'#.###.###.',
'#.........',
'##........',
'....#....#',
'###...#...',
'#......###',
'.#........',
'#..#.....#',
'.......#.#',
'..###....#'],

2039:[
'.##..#####',
'#.#....###',
'.....#....',
'.#....##..',
'#......#..',
'....#.#...',
'##...##..#',
'#.....#..#',
'......#..#',
'#.#..#.###'],

1847:[
'#..#..##.#',
'..........',
'####.....#',
'..........',
'##...#.#.#',
'..........',
'##....#..#',
'#....#...#',
'..##......',
'....#.####'],

1427:[
'#....#...#',
'#....##..#',
'#..#####..',
'#.#.#....#',
'..........',
'....#....#',
'##.......#',
'.....#...#',
'#.#..##..#',
'.#...#..##'],

2207:[
'#..#####.#',
'.##...#.#.',
'...#..#...',
'#...###...',
'##.......#',
'.....#....',
'.#...#...#',
'##.......#',
'##.#...#.#',
'##......#.'],

2393:[
'###..##.#.',
'#..#..#.#.',
'#.....#.#.',
'#..#......',
'........#.',
'.#.#....#.',
'....##.#..',
'###..#...#',
'#........#',
'.#..#.####'],

1493:[
'#.###.##.#',
'.#.##.##.#',
'.........#',
'..###.....',
'..#....###',
'.#.....#.#',
'.##......#',
'..#......#',
'##.....#.#',
'#.###..#.#'],

3709:[
'###.####.#',
'..#..#..#.',
'#..#...#..',
'.##.....#.',
'..#...#...',
'.........#',
'........##',
'........#.',
'.........#',
'#..#....##'],

3889:[
'#.#..##.#.',
'.#....#..#',
'...##..##.',
'#.....#...',
'#...##....',
'..##......',
'#.###.#...',
'......#...',
'.#.##.....',
'..###.##..'],

2029:[
'##..#.....',
'...###.#.#',
'....#...##',
'.........#',
'#....#...#',
'#........#',
'###.#.....',
'......###.',
'...##..#..',
'.#.#.#.#..'],

1699:[
'#.###..#.#',
'....##...#',
'....#....#',
'#.#.#...#.',
'##......##',
'#..#...###',
'..#...#.##',
'.......#..',
'#....#..##',
'#..#.##.##'],

2269:[
'####...##.',
'.###......',
'#.....#..#',
'#.#.#..#..',
'##..#.....',
'###..###.#',
'..........',
'........#.',
'##.##.#...',
'####...###'],

3373:[
'###..##..#',
'.......#..',
'.........#',
'#........#',
'......#...',
'...##..#..',
'#.#.....#.',
'##......##',
'..#.....##',
'.#.#.....#'],

1423:[
'##.###...#',
'...##...#.',
'..#..#..#.',
'##.###...#',
'#.#.....##',
'..#.......',
'#...#..#.#',
'#.....#...',
'..#.#.....',
'#.#..#.#.#'],

3137:[
'##...#...#',
'..#....#.#',
'#..#...###',
'##.#.#...#',
'......#...',
'.##.#....#',
'..##.#..#.',
'##.##....#',
'.##..##...',
'##.#..####'],

2381:[
'#.....##..',
'#....#....',
'#.#..#.#..',
'#.#....#..',
'#.#..#..##',
'##...#..#.',
'#.###....#',
'#..#..#..#',
'.#.#.#.#..',
'##..###.##'],

1151:[
'.#.#...#..',
'.##...#...',
'....#.#..#',
'#.#.##....',
'..........',
'#..####...',
'..#..#....',
'#.#...#..#',
'##..#.#...',
'.#.#..#..#'],

3797:[
'#...##.#.#',
'#...###...',
'##.#.##..#',
'##..#..#..',
'.#....#...',
'#.#.###...',
'#.....#...',
'##.....#..',
'#.#......#',
'.....#..##'],

2609:[
'.#...#.###',
'.....#....',
'#..#..#..#',
'.#......#.',
'......#...',
'.........#',
'#...#..#.#',
'#..##..#.#',
'##..#.#.##',
'.###....##'],

3251:[
'..#..##...',
'..........',
'....#.....',
'#.#.....#.',
'#.##...#..',
'#........#',
'#....##...',
'###...####',
'#.....##..',
'#.##...##.'],

2273:[
'####..###.',
'......#..#',
'#.#...#...',
'#..#.....#',
'........#.',
'........#.',
'####...#..',
'#.........',
'##..#....#',
'.##.###..#'],

2053:[
'####..###.',
'..........',
'...#......',
'.....#...#',
'#..#..#...',
'#....#...#',
'.#........',
'.........#',
'#.....#...',
'.#.###.#..'],

3623:[
'..#..#.###',
'#.#......#',
'#...#.....',
'#...#...#.',
'####..###.',
'##...##..#',
'......#.#.',
'#...###...',
'......#...',
'#.#..#####'],

3389:[
'...#..##..',
'...###....',
'..#......#',
'.#..##.#.#',
'.#..#.#...',
'##...#....',
'.....#.#..',
'##...#.#..',
'..#.......',
'..#.#.#...'],

3803:[
'.#.#.#.###',
'###.#....#',
'..#......#',
'#.#.......',
'#....#...#',
'##.......#',
'##.....#.#',
'##..#..#..',
'#.#####.#.',
'####.#....'],

1871:[
'.##..##.#.',
'#....#..##',
'..........',
'....#....#',
'##...#...#',
'#....#...#',
'##..###..#',
'##.#.#...#',
'........##',
'.....##..#'],

1021:[
'###...#..#',
'#.#.......',
'#..#......',
'###..#....',
'##...#.#.#',
'.#.###..#.',
'###.#...##',
'##...##..#',
'.#.#..#..#',
'#####.###.'],

2011:[
'..#.###..#',
'#......#.#',
'##.##..#..',
'.##..#...#',
'##.#..##.#',
'....##....',
'....#....#',
'#.....#...',
'#..#..#..#',
'##..######'],

2707:[
'#.###.#...',
'..........',
'.#.#...#..',
'...#.#...#',
'##..##...#',
'#...#....#',
'......#...',
'#...#.....',
'##...#...#',
'##.##..##.'],

3691:[
'##.#..#...',
'##......##',
'.#.......#',
'###..#..##',
'#..##....#',
'.##.#.....',
'..#....#.#',
'#..#.....#',
'#..#....#.',
'#####.#.#.'],

3449:[
'.#.##.#..#',
'#..##..#.#',
'#...#..###',
'##.......#',
'#.....#.##',
'....#.....',
'.........#',
'#..#.##..#',
'....#....#',
'...####..#'],

1667:[
'.#.####.##',
'...#.....#',
'..#..#....',
'.##.#.....',
'#.#.......',
'...#..#.#.',
'#...#....#',
'......#.##',
'#.##..#...',
'.#.####...'],

3319:[
'...#....#.',
'#.##..#.#.',
'#......#..',
'#...#.....',
'..###....#',
'#.#....#..',
'#........#',
'.........#',
'###......#',
'#...#...#.'],

1013:[
'....#...#.',
'#..#.#...#',
'#.........',
'#........#',
'#.#.......',
'#..#.#..#.',
'#.###...#.',
'...#.....#',
'.......##.',
'##.#.#.##.'],

2797:[
'..##.###..',
'.#.....#.#',
'#..#.#...#',
'##.#.#....',
'#..#....#.',
'##..#.##..',
'#.#..#....',
'#..#.#....',
'#.#..#...#',
'##.#...#.#'],

2347:[
'####.##.#.',
'##..#.#...',
'#.#.......',
'#..#..##..',
'.#..#...#.',
'#.#..###.#',
'.....##.##',
'.....#....',
'#....#....',
'#.#.#.##.#'],

3793:[
'..#..##.#.',
'.........#',
'...##....#',
'..........',
'..#....#.#',
'......#...',
'.#....#.##',
'...##..##.',
'#.....#...',
'.###......'],

1409:[
'.#.#......',
'#....#....',
'...#..#.#.',
'...#..#..#',
'#...#.....',
'......#...',
'#....#.#..',
'#.#......#',
'#.#.#..#.#',
'#####.#.#.'],

2141:[
'##...#.#..',
'...##....#',
'.#........',
'##.#...##.',
'..#.......',
'#..##....#',
'.##..#....',
'.###..###.',
'.....#.#.#',
'#..#...#.#'],

1697:[
'.###..##.#',
'...#.#..##',
'.#..#.####',
'####....##',
'#.#.......',
'.#...#....',
'#.....#...',
'.#.#..##..',
'.##....#.#',
'##.##.#.#.'],

1291:[
'#######..#',
'.##..#.#..',
'##.#...#.#',
'##.......#',
'.....##..#',
'#.#..#.#.#',
'...###.#.#',
'#.##......',
'#...#..#..',
'...###..#.'],

3023:[
'#.##.#..##',
'#......#..',
'#..#..##..',
'.#...#..##',
'#.#......#',
'#.#....#.#',
'.#..#.##..',
'.#....#..#',
'....#...#.',
'##.##.#...'],

1213:[
'...#.##.##',
'....#...##',
'#......#..',
'.........#',
'.........#',
'.#.##....#',
'#.....#..#',
'#........#',
'.....#..#.',
'###..###.#'],

1399:[
'#.###.####',
'##..###...',
'..##...#..',
'##...#.#.#',
'.........#',
'#...#.....',
'..##.....#',
'#.#.#.#..#',
'..........',
'##...#.#.#'],

2557:[
'##.#.#####',
'#....#..#.',
'#....##...',
'#.#.......',
'#.#..#....',
'..#....#..',
'..#..#..#.',
'##..#.##.#',
'##.......#',
'##....##..'],

1979:[
'....#..###',
'#.......#.',
'...#.....#',
'..#....#.#',
'#.....#...',
'...##....#',
'#.......##',
'....#...##',
'#.....#..#',
'#.###.#.##'],

1619:[
'#.#.#.##..',
'##.#......',
'.#........',
'..##.#...#',
'..........',
'#....#....',
'#.....##.#',
'##..#.#...',
'.##..#.###',
'...#.###..'],

2957:[
'#.#.###.##',
'....#.##.#',
'........##',
'#.#.#.....',
'#........#',
'#.....#...',
'...#...###',
'.#.......#',
'#.........',
'##..#..###'],

1933:[
'##.##..#.#',
'......#...',
'#.###....#',
'#...##...#',
'.....#...#',
'#........#',
'#....##..#',
'...#..#...',
'.......###',
'...#.###.#'],

3527:[
'...####.#.',
'.#....##..',
'##.##.###.',
'.....##.#.',
'...#.....#',
'.##.......',
'#..#.##...',
'.#.##.##..',
'.##...##.#',
'.###......'],

3821:[
'#....#.###',
'##.##.....',
'##.#......',
'#..#.#.#..',
'..#.#....#',
'#..#.#..#.',
'##....#..#',
'....#....#',
'...#...#..',
'##.##.###.'],

1549:[
'.###.#....',
'.##.#.....',
'..........',
'#......#..',
'..#...#..#',
'#.....#...',
'#.##.#.#.#',
'#.#.......',
'###....#.#',
'#..######.'],

3271:[
'#....#.##.',
'..........',
'...#......',
'#.#......#',
'#........#',
'##.......#',
'.........#',
'...#...#.#',
'#.....#.##',
'...#..#.##'],

3083:[
'.#####....',
'....#..#..',
'#.........',
'#.#.......',
'#.#......#',
'...#..#...',
'.##..#.###',
'#...#....#',
'.....#....',
'.#.#..####'],

2729:[
'.#..###.#.',
'#.#..##...',
'#..#......',
'.##....#.#',
'......#...',
'.....#.##.',
'.#...##..#',
'##..#..#.#',
'.#......##',
'#####.##..'],

1439:[
'.#..#.##.#',
'.#####...#',
'.....#...#',
'.#........',
'#........#',
'#........#',
'.........#',
'.......#.#',
'#.#....#.#',
'.#..######'],

1747:[
'#..#.#.#.#',
'#.........',
'#.....###.',
'#....#...#',
'##.....#..',
'#........#',
'........##',
'##.#..#.#.',
'#.#.#..##.',
'..#.##...#'],

2287:[
'####..#...',
'#........#',
'#..#..##.#',
'.....#.#..',
'#.#..#..#.',
'##...###.#',
'#..##.#.##',
'###...#...',
'....#....#',
'#..#.#.##.'],

3701:[
'.#.#####..',
'..##.#....',
'.........#',
'.........#',
'#......#..',
'###.......',
'.......#..',
'.#....#.##',
'##.#......',
'....#....#'],

3329:[
'###.##.#.#',
'#..#......',
'#.##......',
'..#.......',
'..........',
'..#......#',
'#..#......',
'##.###....',
'###.....##',
'#.#.##...#'],

3089:[
'.#..##.#.#',
'##.#.##..#',
'#.#.#.##..',
'.......###',
'#.##....##',
'#.....##.#',
'##....#...',
'##.#.....#',
'.###...#..',
'#.......##'],

3347:[
'.#.#..##.#',
'.........#',
'#.....#...',
'#.......##',
'.##.#....#',
'#.........',
'#.#..#....',
'.........#',
'#####..#.#',
'#.#...###.'],

1163:[
'.......###',
'#......#.#',
'.....#...#',
'#.........',
'##...#..#.',
'#...###..#',
'....#..#.#',
'#.........',
'..#......#',
'.##...##.#'],

3719:[
'.####.####',
'..#......#',
'#......#..',
'##....#.#.',
'##...#....',
'.#..#...#.',
'.....#...#',
'#........#',
'..#....#..',
'..#.#...##'],

2113:[
'##.##..#.#',
'#..#.#...#',
'....#..#..',
'....#.....',
'##...##...',
'#.......##',
'#..#.....#',
'.........#',
'##........',
'#....#...#'],

2027:[
'....#.....',
'......####',
'...#....#.',
'#.#......#',
'..#...#...',
'...##...#.',
'.#..#..#.#',
'#.#....#.#',
'#..#..#.#.',
'##..#.##.#'],

1777:[
'.#.#.##...',
'.#...##...',
'#...#..##.',
'#.#.#.....',
'.#.......#',
'..#.##...#',
'#.#.....##',
'........##',
'..........',
'.##....###'],

2857:[
'#.####.#.#',
'#....###..',
'..........',
'#.#.......',
'##.#....##',
'.#...#..#.',
'#.#.#...#.',
'#..#.....#',
'...#......',
'.#...##.##'],

2221:[
'##....###.',
'#........#',
'##.#....#.',
'#..##...#.',
'..#..##.#.',
'#.#.#..#.#',
'.....#####',
'##........',
'...#....#.',
'#..#######'],

2281:[
'.###.####.',
'#.#..#..#.',
'...##....#',
'#....#....',
'#..#......',
'..#......#',
'....#..##.',
'....##..##',
'..#..###..',
'#....#.#.#'],

1597:[
'#..#..#.##',
'##.......#',
'....#.#.#.',
'#......#..',
'.....##...',
'.........#',
'.......#..',
'#....#..#.',
'#........#',
'.#.#.#..##'],

1627:[
'#...#.##..',
'###.......',
'#.........',
'.......#..',
'..###..###',
'##.##.##.#',
'........#.',
'##......#.',
'#...#...##',
'..#...##.#'],

2339:[
'##..##.#.#',
'..#.#....#',
'..##.#....',
'..##..##..',
'...#.....#',
'#..#..#.##',
'....#.....',
'##.#.#....',
'...#......',
'...#.#.###'],

2161:[
'#..#.###..',
'#........#',
'...#.#....',
'.....#.#.#',
'.....#.##.',
'#...#..###',
'#.#...#..#',
'#.........',
'#........#',
'#..##..#..'],

2617:[
'#.....##..',
'..........',
'..#.##...#',
'##.##.....',
'..#......#',
'#..#..##..',
'####.#...#',
'##..#.....',
'.........#',
'#.....###.'],

2837:[
'#.#.######',
'...#.#...#',
'...##.....',
'#....#..##',
'.####..#.#',
'....#....#',
'#..#.....#',
'.#....#.##',
'#..#.#..##',
'...#####..'],

3917:[
'.....####.',
'..........',
'#..#.#.###',
'#........#',
'..........',
'.#.#...#..',
'...#....#.',
'#...#.....',
'...#...#..',
'##....#.#.'],

1223:[
'.##.#.##.#',
'.#....#..#',
'........#.',
'#.....#..#',
'#.#..###.#',
'.###...#.#',
'#....#.#.#',
'##.##..#..',
'.....###..',
'#.########'],

2579:[
'..#.##.###',
'##.......#',
'..#...#.#.',
'......#..#',
'#...#.....',
'...#.#...#',
'#.........',
'....#..#..',
'.........#',
'#.#.#....#'],

1451:[
'#.###..##.',
'..#......#',
'##....#...',
'.##...###.',
'.......#.#',
'#....#...#',
'#.#.......',
'##..#..###',
'##.#.##.#.',
'.#####...#'],

2683:[
'###..#....',
'#.......#.',
'#......#.#',
'.#.##...##',
'.#....#..#',
'.##....#.#',
'.#.......#',
'.....#..#.',
'#........#',
'.#.####..#'],

2467:[
'#####.####',
'.....#.#.#',
'#..#....#.',
'.......#.#',
'.......#.#',
'.......#..',
'#........#',
'......#..#',
'#.#.......',
'#..#..#.##'],

1361:[
'##.##....#',
'##.##.##.#',
'.........#',
'#..#.##.##',
'.....#....',
'.....#....',
'........##',
'.#.......#',
'###.......',
'#.####.##.'],

3019:[
'..##.###.#',
'###.......',
'.........#',
'.#....##.#',
'..#......#',
'#.........',
'#.#..#..##',
'........#.',
'..........',
'##.####..#'],

2081:[
'...#......',
'##...#....',
'##....#..#',
'#......###',
'###..##.##',
'..#...#.##',
'.#....##.#',
'.#..##....',
'##.#..##.#',
'..#...#.##'],

3923:[
'.##.#.#..#',
'#........#',
'...#.....#',
'#...#....#',
'....#.....',
'#......#..',
'.....#...#',
'###..#..##',
'#.......#.',
'#.###..##.'],

1811:[
'.######.##',
'##........',
'...#..#.##',
'#....#...#',
'..........',
'#.....#.#.',
'......#...',
'.##...#.#.',
'#.#.#.##.#',
'##.##..#..'],

1709:[
'..###.....',
'#..#.....#',
'...#..#..#',
'......#...',
'#......##.',
'##.#.##...',
'##.#.#....',
'........#.',
'###......#',
'.#.##.#..#'],

1181:[
'.##..#####',
'##....##..',
'......####',
'###....#.#',
'#.........',
'#........#',
'#.#..#.##.',
'#..##.#...',
'......#...',
'..##...###'],

3467:[
'..#......#',
'#...#..#..',
'.#.#......',
'##..#...#.',
'...##..#.#',
'#...###..#',
'#....##..#',
'.....#....',
'#...#.#.#.',
'##.#.##...'],

1787:[
'#..##.#...',
'...##.....',
'.#...####.',
'..#..#..#.',
'#.#.##..#.',
'.........#',
'##...#...#',
'........##',
'.....#.#..',
'#..##.###.'],

1231:[
'.#.....#.#',
'.#.#...###',
'#....#..#.',
'#.#.#.....',
'......#...',
'..#.......',
'#.#..###..',
'.##.#.#..#',
'....##...#',
'###.#.####'],

2377:[
'####.#.##.',
'.#.......#',
'..#..#.#.#',
'..#..#...#',
'.#......#.',
'#.#...#.#.',
'#.#..#...#',
'#....#....',
'......#..#',
'..##..#.##'],

1997:[
'.#...###..',
'.#..##..#.',
'...#..#...',
'...#..#...',
'##..#.#.##',
'#..##...##',
'.#..#....#',
'##.......#',
'#..#.#....',
'#.#.#.#.##'],

1289:[
'....###..#',
'.....#..##',
'#...#.##.#',
'#..#.....#',
'.#.......#',
'###....#.#',
'#..#..#..#',
'#....#.#..',
'#.#......#',
'...####.##'],

1093:[
'#..#.#####',
'.##..#....',
'.........#',
'.....##..#',
'#......###',
'..#..#...#',
'.#........',
'#........#',
'.#........',
'.#.#......'],

1609:[
'#####..###',
'.......##.',
'#...#..#..',
'#........#',
'#..#..#..#',
'.#........',
'..#.......',
'..#...#...',
'#.....#..#',
'#.###..###'],

3049:[
'#......#..',
'#...#..#..',
'....#...##',
'....##....',
'.....#....',
'..........',
'....##....',
'#...#....#',
'....#....#',
'##..####.#'],

1483:[
'###.....#.',
'#...##....',
'#.#.....##',
'#...#.....',
'#.....##..',
'..........',
'#....#...#',
'####......',
'#.......#.',
'.#####.###'],

3581:[
'##...#####',
'..........',
'.#.......#',
'......#...',
'..........',
'#..#....#.',
'##...#.##.',
'##.....###',
'#.#..#.#.#',
'#...######'],

2143:[
'....##..##',
'.........#',
'....##..#.',
'#......#..',
'...#......',
'........##',
'.#.#.....#',
'..........',
'##........',
'.#.####.##'],

1601:[
'...##..##.',
'...#......',
'..##....##',
'..##..#.#.',
'#.....##.#',
'##.....###',
'#.#.......',
'#.........',
'#.#..#....',
'#..###...#'],

3121:[
'..###.#..#',
'......#...',
'..#......#',
'........#.',
'.........#',
'.#......#.',
'#.#....#.#',
'....##....',
'....#..###',
'#.....#.#.'],

2909:[
'.##.....#.',
'#.........',
'.#.......#',
'.###......',
'#.##.#..##',
'#.#.#...#.',
'#.....##..',
'##.......#',
'##......#.',
'###.###.##'],

2477:[
'###.#..#..',
'##....#.##',
'.....#...#',
'#..#..##.#',
'....#....#',
'#........#',
'...#..#.##',
'##....#.##',
'#.#.......',
'#..#...#..'],

2267:[
'.##....#.#',
'#.....#...',
'#.....##..',
'#..#..##..',
'.#...#.#..',
'#....#..##',
'#....#.#..',
'...#..##..',
'.....##..#',
'#.##....##'],


}


part1 = run1()
print(f'Part1: {part1}')

part2 = run2()
print(f'Part2: {part2}')

print(f'Took {time.time()*1000 - ms}ms')